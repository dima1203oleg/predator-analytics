# ü§ñ Predator Analytics Telegram Bot

–Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π AI-–ø–æ–º—ñ—á–Ω–∏–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ Telegram.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É
```bash
cd /Users/dima-mac/Documents/Predator_21/scripts
python3 telegram_bot.py
```

### –ó–∞–ø—É—Å–∫ —è–∫ —Å–µ—Ä–≤—ñ—Å (–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫)
```bash
cd /Users/dima-mac/Documents/Predator_21/scripts
./install_telegram_bot.sh
# –í–∏–±–µ—Ä–∏ –æ–ø—Ü—ñ—é 2
```

## ‚ú® –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

### üîó –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è ngrok/SSH

–ö–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è —ñ –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∏–ø—É:
```
üîó Ngrok URLs
SSH: tcp://7.tcp.eu.ngrok.io:15102
HTTP: https://example.ngrok-free.dev
```

–ë–æ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ**:
1. –ü–∞—Ä—Å–∏—Ç—å –Ω–æ–≤—ñ ngrok –¥–∞–Ω—ñ
2. –û–Ω–æ–≤–ª—é—î `~/.ssh/config`
3. –ü–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ —É—Å–ø—ñ—à–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—å –ø—Ä–æ—Å—Ç–æ:
```bash
ssh dev-ngrok
```

### üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å |
|---------|------|
| `/status` | –ó–∞–≥–∞–ª—å–Ω–∏–π —Å—Ç–∞—Ç—É—Å |
| `/disk` | –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–∏—Å–∫—É |
| `/memory` | RAM —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| `/cpu` | CPU –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è |
| `/uptime` | –ê–ø—Ç–∞–π–º —Å–∏—Å—Ç–µ–º–∏ |

### üê≥ Docker/Kubernetes

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å |
|---------|------|
| `/docker` | –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ |
| `/pods` | K8s –ø–æ–¥–∏ |
| `/logs [—Å–µ—Ä–≤—ñ—Å]` | –õ–æ–≥–∏ —Å–µ—Ä–≤—ñ—Å—É |

### üîó –ú–µ—Ä–µ–∂–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å |
|---------|------|
| `/ngrok` | –ü–æ—Ç–æ—á–Ω—ñ ngrok –¥–∞–Ω—ñ |
| `/ssh` | SSH –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è |
| `/connect` | –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è |

### üì¶ Deploy

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å |
|---------|------|
| `/git` | Git —Å—Ç–∞—Ç—É—Å |
| `/deploy` | Deploy —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è |
| `/argocd_apps [target]` | –ü–æ–∫–∞–∑–∞—Ç–∏ ArgoCD –¥–æ–¥–∞—Ç–∫–∏ (target: nvidia|oracle|macbook) |
| `/argocd [app|target]` | –î—ñ–∑–Ω–∞—Ç–∏—Å—å —Å—Ç–∞—Ç—É—Å ArgoCD –¥–æ–¥–∞—Ç–∫–∞ |
| `/argocd_sync confirm [app|target]` | –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é ArgoCD (–ø–æ—Ç—Ä—ñ–±–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è) |
| `/argocd_sync_status [app|target] [wait]` | –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó (–ø–∞—Ä–∞–º–µ—Ç—Ä `wait` –æ—á—ñ–∫—É—î –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è) |
| `/auto_deploy on|off|status` | –í–∫–ª—é—á–∏—Ç–∏/–≤–∏–º–∫–Ω—É—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤–∏–∫–ª–∏–∫ ArgoCD –ø—Ä–∏ –ø—ñ–¥–Ω—è—Ç—Ç—ñ —Ç—É–Ω–µ–ª—é |

## üì± –ú–µ–Ω—é

–ü—ñ—Å–ª—è `/start` –∑'—è–≤–∏—Ç—å—Å—è –∑—Ä—É—á–Ω–µ –º–µ–Ω—é –∑ –∫–Ω–æ–ø–∫–∞–º–∏:
- üìä –°—Ç–∞—Ç—É—Å
- üñ•Ô∏è –°–µ—Ä–≤–µ—Ä  
- üê≥ Docker
- ‚ò∏Ô∏è K8s
- üîó Ngrok
- üì° SSH Config
- üì¶ Deploy
- ‚ùì –î–æ–ø–æ–º–æ–≥–∞

## üí¨ –ü—Ä–∏—Ä–æ–¥–Ω—è –º–æ–≤–∞

–ë–æ—Ç —Ä–æ–∑—É–º—ñ—î –∑–∞–ø–∏—Ç–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é:
- "–ø–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞"
- "—Å–∫—ñ–ª—å–∫–∏ –ø–∞–º'—è—Ç—ñ"
- "—è–∫ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—å"
- "–ø–æ–∫–∞–∂–∏ –ª–æ–≥–∏"

## üîß –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤:
- –ó–º—ñ–Ω–Ω—ñ–π `TELEGRAM_BOT_TOKEN`
- –ê–±–æ –Ω–∞–ø—Ä—è–º—É –≤ `telegram_bot.py`

SSH –∫–æ–Ω—Ñ—ñ–≥ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤:
- `~/.ssh/config` (–±–ª–æ–∫ `Host dev-ngrok`)

 –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è & ArgoCD:
 - `AUTO_DEPLOY_ON_UP` ‚Äî —è–∫—â–æ `true`, `ngrok_monitor.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—î ArgoCD sync, –∫–æ–ª–∏ —Å–µ—Ä–≤—ñ—Å –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –≤ UP –ø—ñ—Å–ª—è –ø–∞–¥—ñ–Ω–Ω—è. 
 - `ARGOCD_INSECURE` ‚Äî —è–∫—â–æ `true`, –±–æ—Ç –¥–æ–∑–≤–æ–ª–∏—Ç—å –Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ (self-signed) –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É ArgoCD API (use cautiously)
 - `ARGOCD_API_RETRIES`, `ARGOCD_API_BACKOFF` ‚Äî –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä—ñ–≤ —Ç–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É ArgoCD API
 - `PREDATOR_TELEGRAM_STATE` ‚Äî —à–ª—è—Ö –¥–æ JSON-—Ñ–∞–π–ª–∞, –≤ —è–∫–æ–º—É –±–æ—Ç –∑–±–µ—Ä—ñ–≥–∞—î –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (default: `~/.predator_bot_state.json`)
- `AUTO_ROLLBACK_ON_DEGRADE` ‚Äî —è–∫—â–æ `true`, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–ø—Ä–æ–±—É—î –≤–∏–∫–æ–Ω–∞—Ç–∏ rollback –∫–æ–ª–∏ ArgoCD –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å —Ö–≤–∏–ª—é (Degraded/Progressing -> Degraded)
- `ARGOCD_NVIDIA_URL` / `ARGOCD_NVIDIA_TOKEN` ‚Äî —è–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ, —Å–∫—Ä–∏–ø—Ç–∏ —Ç–∞ –±–æ—Ç –±—É–¥—É—Ç—å —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é ArgoCD –¥–ª—è `predator-nvidia` –∑–∞–º—ñ—Å—Ç—å –ø—Ä—è–º–æ–≥–æ `docker-compose` –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.
- `AUTO_RESTART_NGROK` ‚Äî —è–∫—â–æ `true`, –±–æ—Ç —Å–ø—Ä–æ–±—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ ngrok –ø—Ä–∏ –ø–∞–¥—ñ–Ω–Ω—ñ —Ç—É–Ω–µ–ª—é.
- `AUTO_DEPLOY_ON_UP` ‚Äî —è–∫—â–æ `true`, `ngrok_monitor.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—î ArgoCD sync, –∫–æ–ª–∏ —Å–µ—Ä–≤—ñ—Å –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –≤ UP –ø—ñ—Å–ª—è –ø–∞–¥—ñ–Ω–Ω—è. 
- `ARGOCD_INSECURE` ‚Äî —è–∫—â–æ `true`, –±–æ—Ç –¥–æ–∑–≤–æ–ª–∏—Ç—å –Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ (self-signed) –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É ArgoCD API (use cautiously)
- `ARGOCD_API_RETRIES`, `ARGOCD_API_BACKOFF` ‚Äî –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä—ñ–≤ —Ç–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É ArgoCD API

## üìù –õ–æ–≥–∏

```bash
# Foreground
# –í–∏–≤–æ–¥—è—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

# Background (launchd)
tail -f ~/Library/Logs/telegram-bot.log
```

## üõë –ó—É–ø–∏–Ω–∫–∞

### Foreground
`Ctrl+C`

### Background
```bash
launchctl unload ~/Library/LaunchAgents/com.predator.telegram-bot.plist
```

–ê–±–æ —á–µ—Ä–µ–∑ —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä:
```bash
./install_telegram_bot.sh
# –í–∏–±–µ—Ä–∏ –æ–ø—Ü—ñ—é 3
```

## üîê –ë–µ–∑–ø–µ–∫–∞

- –¢–æ–∫–µ–Ω –±–æ—Ç–∞ **–ù–ï** –ø—É—à–∏—Ç—å—Å—è –≤ git (–¥–æ–¥–∞–Ω–æ –≤ `.gitignore`)
- –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è
- –ú–æ–∂–Ω–∞ –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `AUTHORIZED_USERS`

## üèó –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
scripts/
‚îú‚îÄ‚îÄ telegram_bot.py              # –ì–æ–ª–æ–≤–Ω–∏–π standalone –±–æ—Ç
‚îú‚îÄ‚îÄ install_telegram_bot.sh      # –Ü–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä
‚îî‚îÄ‚îÄ com.predator.telegram-bot.plist  # LaunchAgent

ua-sources/
‚îú‚îÄ‚îÄ app/services/
‚îÇ   ‚îú‚îÄ‚îÄ telegram_assistant.py    # –ü–æ–≤–Ω–∏–π –∞—Å–∏—Å—Ç–µ–Ω—Ç (–∑ AI)
‚îÇ   ‚îî‚îÄ‚îÄ telegram_bot.py          # –ë–∞–∑–æ–≤–∏–π —Å–µ—Ä–≤—ñ—Å
‚îú‚îÄ‚îÄ app/api/routers/
‚îÇ   ‚îî‚îÄ‚îÄ telegram.py              # API —Ä–æ—É—Ç–µ—Ä (webhook)
‚îî‚îÄ‚îÄ run_telegram_bot.py          # –ó–∞–ø—É—Å–∫ –∑ FastAPI
```

## üéØ TODO

- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ AI Engine –¥–ª—è –ø–æ—à—É–∫—É
- [ ] –í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
- [ ] –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –≥—Ä–∞—Ñ—ñ–∫–∏
